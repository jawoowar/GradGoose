-- joins
SELECT tescoI.*, tescoStoreD.*-- , BeanD.* --, StudentD.*
FROM TescoItems tescoI
LEFT JOIN TescoStoreDiscount tescoStoreD ON tescoI.StoreDiscountID = tescoStoreD.DiscountID
LEFT Join StudentDiscount StudentD ON tescoI.StudentDiscountID = StudentD.DiscountID
LEFT JOIN StudentBeanDiscount BeanD ON tescoI.StudentBeanDiscountID = BeanD.DiscountID
WHERE tescoI.StoreDiscountID IS NOT NULL;

SELECT ti.*,
    tsd.DiscountID as StoreDiscountID,
    tsd.Discount as StoreDiscountPercent,
    tsd.Criteria as StoreDiscountCriteria,
    sd.DiscountID as StudentDiscountID,
    sd.Discount as StudentDiscountPercent,
    sd.Criteria as StudentDiscountCriteria,
    sbd.DiscountID as StudentBeanDiscountID,
    sbd.Discount as StudentBeanDiscountPercent,
    sbd.Criteria as StudentBeanDiscountCriteria
    
FROM TescoItems ti
LEFT JOIN StudentBeanDiscount sbd ON ti.StudentBeanDiscountID = sbd.DiscountID
LEFT JOIN StudentDiscount sd ON ti.StudentDiscountID = sd.DiscountID
LEFT JOIN TescoStoreDiscount tsd ON ti.StoreDiscountID = tsd.DiscountID

WHERE ti.Price > 0  -- Filter out invalid prices
ORDER BY ti.Catagory, ti.ItemName;